<!DOCTYPE html>
<html lang="ru">
<head><meta charset="UTF-8"><meta name="viewport" content="width=device-width">
<title>Калькулятор калорий + Nous AI</title>
<style>
  body{font-family:sans-serif;padding:20px;background:#f5f5f5;}
  input,button{padding:10px;margin:5px;font-size:1rem;}
  table{width:100%;border-collapse:collapse;margin-top:20px;}
  th,td{padding:8px;border:1px solid #ccc;text-align:center;}
  #loading{display:none;color:green;}
</style>
</head>
<body>
  <h1>Калькулятор калорий (Nous AI)</h1>
  <input id="prod" placeholder="Название продукта">
  <input id="g" type="number" value="100">
  <button onclick="add()">Добавить</button>
  <span id="loading">Загрузка...</span>
  <table><thead><tr><th>Продукт</th><th>г</th><th>Белки</th><th>Жиры</th><th>Углеводы</th><th>Ккал</th></tr></thead>
  <tbody id="tb"></tbody></table>

  <script>
    async function add(){
      const name = document.getElementById('prod').value;
      const grams = +document.getElementById('g').value;
      if(!name||!grams) return alert('Введите данные');
      document.getElementById('loading').style.display='inline';
      try{
        const res = await fetch('http://localhost:3000/api/nutrition',{
          method:'POST',
          headers:{'Content-Type':'application/json'},
          body:JSON.stringify({product:name, grams})
        });
        const j = await res.json();
        const row = `<tr>
          <td>${name}</td><td>${grams}</td>
          <td>${j.proteins}</td><td>${j.fat}</td>
          <td>${j.carbs}</td><td>${j.calories}</td>
        </tr>`;
        document.getElementById('tb').innerHTML+=row;
      } catch(e){ alert('Ошибка: '+e.message); }
      document.getElementById('loading').style.display='none';
    }
  </script>
</body>
</html>
